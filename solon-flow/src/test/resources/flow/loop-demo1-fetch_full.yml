id: fetch2
title: "采集（完整结构）"
layout:
  - task: 'context.put("a", new java.util.concurrent.atomic.AtomicInteger(0));'
  - task: 'context.put("b", new java.util.concurrent.atomic.AtomicInteger(0));'
  - task: 'context.put("c", new java.util.concurrent.atomic.AtomicInteger(0));'
  - task: "@fetchBanduCommunity"
  - { type: loop, id: fetch-album, meta: { "$for": "communityId", "$in": "communityIds" } }
  - task: "@fetchBanduAlbum"
  - { type: loop, id: fetch-course,  meta: { "$for": "albumId", "$in": "albumIds" } }
  - task: "@fetchBanduCourse"
  - { type: loop, id: fetch-content, meta: { "$for": "courseId", "$in": "courseIds" } }
  - task: "@fetchBanduContent"
  - task: "@downloadBanduAttachment"
  - task: "@convertBanduAttachment"
  - task: "@markdownBanduAttachment"
  - {type: loop, id: fetch-content_end}
  - task: 'a.incrementAndGet();'
  - {type: loop, id: fetch-course_end}
  - task: 'b.incrementAndGet();'
  - {type: loop, id: fetch-album_end}
  - task: 'c.incrementAndGet();'
